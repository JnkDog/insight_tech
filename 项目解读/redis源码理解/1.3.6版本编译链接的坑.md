# redis 1.3.6ç‰ˆæœ¬ç¼–è¯‘çš„å‘
## é—®é¢˜æè¿°
åœ¨Ubuntu 20.04.1, æ­£å¸¸æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§å®˜ç½‘æ‹‰çš„makefileè¿›è¡Œç¼–è¯‘çš„è¯ï¼Œä¼šå‡ºçŽ°
```shell
redis.o: In function computeObjectSwappability': /home/redis/redis/redis.c:8748: undefined reference tolog'
collect2: ld returned 1 exit status
```
å¯ä»¥çœ‹åˆ°æ˜¯ ld é“¾æŽ¥é”™è¯¯
æŸ¥äº†ä¸€ä¸‹googleï¼Œéœ€è¦å°†-lmé“¾æŽ¥ç¬¦å·æ”¾åˆ°æœ€æœ«å°¾ï¼Œå¦åˆ™å°±ä¼šå‡ºçŽ°é“¾æŽ¥å¤±è´¥çš„æƒ…å†µã€‚
```shell
# wrong
cc -lm mypro.c
# right
cc mypro.c -lm
```
å¦‚æžœ-lmåœ¨å‰é¢ï¼Œé‚£ä¹ˆè¿žæŽ¥å™¨ä¸çŸ¥é“åŽé¢çš„ç¨‹åºæ˜¯å¦éœ€è¦åº“ï¼Œä¼šé€ æˆldå¤±è´¥ã€‚
æ‰€ä»¥éœ€è¦ä¿®æ”¹redis makefileä¸­çš„-lmä½ç½®ï¼Œå°†ä»–ä¿®æ”¹åˆ°åŽé¢
```shell
# åŽŸMakefile
# æ³¨ï¼š$(CCOPT) = $(CFLAGS) $(CCLINK) $(ARCH) $(PROF)
redis-server: $(OBJ)
	$(CC) -o $(PRGNAME) $(CCOPT) $(DEBUG) $(OBJ)

# ä¿®æ”¹ä¸‹
redis-server: $(OBJ)
	$(CC) -o $(PRGNAME) $(CFLAGS) $(ARCH) $(PROF) $(DEBUG) $(OBJ) $(CCLINK)
```
make clean åŽé‡æ–° make ä¸‹å°±æˆåŠŸäº†

PSï¼š-lmæœ‰ä»€ä¹ˆç”¨
é¦–å…ˆæ˜Žç™½-læœ‰ä»€ä¹ˆç”¨
-l = -llibrary åˆ¶å®šç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨çš„åº“
ðŸŒ°ï¼š
```shell
# ä½¿ç”¨ ncurses åº“ç¼–è¯‘ç¨‹åº
gcc -lcurses hello.cã€€ã€€
```
é‚£ä¹ˆmè¿™é‡Œä»£è¡¨çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
-lmæ˜¯ç®€å†™ï¼Œå®ƒä»£è¡¨çš„æ˜¯æ ‡å‡†åº“ç›®å½•ä¸­åä¸ºlibm.aæˆ–è€…libm.soçš„å‡½æ•°é“¾æŽ¥åº“ã€‚ ---> å¦‚ä½•æŸ¥è¯¢è¿™äº›ç¼–è¯‘é€‰é¡¹tbc 